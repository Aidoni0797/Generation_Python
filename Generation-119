Generation-119

Тема урока: вложенные словари, генераторы словарей

1. Вложенные словари
2. Генераторы словарей

Аннотация. Урок посвящен вложенным словарям и генераторам словарей.

Вложенные словари

Словари могут содержать другие словари, которым сами, в свою очередь, содержат словари, и так далее на любую глубину. Такие слвоари называются вложенными словарями (мы уже сталкивались
с вложенными списками и кортежами). Вложенные словария - один из способов представления структурированной информации.

Создание вложенныз словарей

Вложенный словарь создается как обычный, только каждое значение в нем - другой словарь.

Приведенный ниже код создает словарь для хранения информации о сотрудниках некоторой компании.

info = {
  'emp1': {'name':'Timur', 'job':'Teacher'},
  'emp2': {'name':'Ruslan','job':'Developer'},
  'emp3': {'name':'Rustam', 'job':'Tester'}
}

Тот же самый словарь info может быть создан по-дргуому:
info = dict(
        emp1 = {'name':'Timur', 'job': 'Teacher'},
        emp2 = {'name':'Ruslan', 'job': 'Developer'},
        emp3 = {'name':'Rustam', 'job': 'Tester'}
)

или

ids = ['emp1', 'emp2', 'emp3']

emp_info = [
  {'name':'Timur', 'job':'Teacher'},
  {'name':'Ruslan', 'job':'Developer'},
  {'name':'Rustam', 'job':'Tester'}
]

info = dict(zip(ids, emp_info))

Число уровне вложенности словарей неограниченно!

Обращение к элементам вложенного словаря


Для того чтобы получить значения определенных элементов во вложенном словаре, необходимо указать их ключи в нескольких квадратных скобках подобно тому, как мы получали значения во вложенных списках.

Приведенный ниже код:
info = {
  'emp1': {'name':'Timur', 'job':'Teacher'},
  'emp2': {'name':'Ruslan', 'job':'Developer'},
  'emp3': {'name':'Rustam', 'job':'Tester'}
}

print(info['emp1']['name'])
print(info['emp2']['job'])
выводит:
Timur
Developer

При попытке обращения по несуществующему кл.чу возникнет ошибка KeyError. Для того чтобы избежать возникновения такой ошибки, используйте словарный метод get(), который по умолчанию 
возвращает значение None, если ключ отсутствует в словаре.

Изменение вложенных словарей.

Чтобы изменить значение определенного элемента во вложенном словаре, необходимо обратиться к его ключу и использовать оператор присвоения (=).

Приведенный ниже код:

info = {
  'emp1': {'name':'Timur', 'job': 'Teacher'},
  'emp2': {'name':'Ruslan', 'job': 'Developer'},
  'emp3': {'name':'Rustam', 'job': 'Tester'}
}

info['emp1']['job'] = 'Manager'

print(info['emp1'])

выводит:
{'name':'Timur', 'job':'Manager'}

Итерация по вложенным словарям

Итерации по вложенным словарям осуществляются как правило двумя циклами for (иногда достаточно одного цикла).

Приведенный ниже код:

info = {
  'emp1': {'name':'Timur','job':'Teacher'},
  'emp2': {'name':'Ruslan', 'job': 'Developer'},
  'emp3': {'name': 'Rustam', 'job': 'Tester'}
}

for emp in info:    
  print('Employee ID:', emp)
  for key in info[emp]:
    print(key+':',info[emp][key])
  print()

выводит:
Employee ID: emp1
name: Timur
job: Teacher

Employee ID: emp2
name: Ruslan
job: Developer

Employee ID: emp3
name: Rustam
job: Tester

Аналогичного результта можно было добиться с пмощью метода items():

info = {
  'emp1': {'name':'Timur', 'job': 'Teacher'},
  'emp2': {'name':'Ruslan', 'job': 'Developer'},
  'emp3': {'name': 'Rustam', 'job': 'Tester'}
}

for emp, inf in info.items():
  print('Employee ID:', emp)
  for key in inf:
    print(key+':', inf[key])
  print()

Генераторы словарей

Пусть требуется создать словарь, ключами которого будут числа от 0 до 5, а значениеями - квадраты ключей.
Для создания требуемого словаря можно использовтаь код:
squares = {}

squares[0] = 0
squares[1] = 1
squares[2] = 4
squares[3] = 9
squares[4] = 16
squares[5] = 25

или 

squares = {0:0, 1:1, 2:4, 3:9, 4: 16,5:25}

или 
squares = {}

for i in range(6):
  squares[i] = i**2

Первые два способа слишком громоздкие и не подходят, когда чисел много. Третий способ полностью решает поставленную задачу, однако его можно переписать в стиле Python с использованием
генератора словаря:

squares = {i: i**2 for i in range(6)}

Общий вид генератора словаря следующий:

{ключ: значение for переменная in последовательность}

где переменная - имя некоторой переменной, последовательность - последовательность значений, которые она принимает (любой итерируемый объект), ключ: значение - некоторое выражение, как правило,
зависящее от использованной в генераторе словаря переменной, которой будут заполнены элементы словаря.

Примеры использования генератора словарей

Генераторы словаря
